<!DOCTYPE html>
<html lang="en">
<head>
<base href="https://cdn.jsdelivr.net/gh/Stinkalistic/SWAGgames@main/coalllc/">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
<title>Coal LLC</title>
<style>
html,body,#canvas{margin:0;padding:0;border:0}
body{color:#fff;background:#000;overflow:hidden;touch-action:none}
#canvas{display:block}
#canvas:focus{outline:none}
</style>
<link id="-gd-engine-icon" rel="icon" type="image/png" href="index.icon.png"/>
<link rel="apple-touch-icon" href="index.apple-touch-icon.png"/>
</head>
<body>
<div id="loadingScreen" style="position:fixed;inset:0;background:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999">
  <img src="https://cdn.jsdelivr.net/gh/TOGZ819/togz8.com/media.png" alt="Logo" style="max-width:300px;margin-bottom:20px">
  <div id="loadingProgress" style="width:300px;height:20px;border-radius:10px;overflow:hidden;background:transparent">
    <div id="loadingBar" style="width:0%;height:100%;background:#4caf50;border-radius:10px;transition:width .2s ease"></div>
  </div>
  <div id="loadingNotice" style="display:none;margin-top:16px;font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;color:#444;text-align:center;max-width:90%"></div>
</div>

<canvas id="canvas">Your browser does not support the canvas tag.</canvas>
<noscript>Your browser does not support JavaScript.</noscript>

<script src="main.js"></script>
<script src="index.js"></script>
<script>
function updateLoadingProgress(p){var b=document.getElementById('loadingBar');if(b)b.style.width=(Math.max(0,Math.min(1,p))*100)+'%'}
function showNotice(text){var n=document.getElementById('loadingNotice');if(n){n.textContent=String(text||'');n.style.display='block'}}
function hideLoadingScreen(){var s=document.getElementById('loadingScreen');if(s)s.style.display='none'}

window.godotRunStart=function(){
  const GODOT_CONFIG={"args":[],"canvasResizePolicy":2,"emscriptenPoolSize":8,"ensureCrossOriginIsolationHeaders":true,"executable":"index","experimentalVK":false,"fileSizes":{"index.pck":141194148,"index.wasm":36160334},"focusCanvas":true,"gdextensionLibs":[],"godotPoolSize":4};
  const GODOT_THREADS_ENABLED=false;
  const engine=new Engine(GODOT_CONFIG);

  function displayFailureNotice(err){
    console.error(err);
    var msg=(err&&err.message)?err.message:(typeof err==='string'?err:'An unknown error occurred.');
    showNotice(msg);
  }

  const missing=Engine.getMissingFeatures({threads:GODOT_THREADS_ENABLED});
  if(missing.length!==0){
    if(GODOT_CONFIG['serviceWorker']&&GODOT_CONFIG['ensureCrossOriginIsolationHeaders']&&'serviceWorker' in navigator){
      let regPromise;
      try{regPromise=navigator.serviceWorker.getRegistration();}catch(e){regPromise=Promise.reject(new Error('Service worker registration failed.'))}
      Promise.race([
        regPromise.then(r=>{if(r!=null){return Promise.reject(new Error('Service worker already exists.'));}return r;}).then(()=>engine.installServiceWorker()),
        new Promise(res=>{setTimeout(()=>res(),2000);})
      ]).then(()=>{window.location.reload();}).catch(err=>{console.error('Error while registering service worker:',err);showNotice('Missing browser features required for Web build.');});
    }else{
      displayFailureNotice('Error\nMissing required web features:\n'+missing.join('\n'));
    }
    return;
  }

  updateLoadingProgress(0);
  engine.startGame({
    onProgress:function(current,total){
      if(current>0&&total>0){updateLoadingProgress(current/total);}else{updateLoadingProgress(0.5);}
    }
  }).then(()=>{updateLoadingProgress(1);setTimeout(hideLoadingScreen,150);},displayFailureNotice);
};
</script>
</body>
</html>
