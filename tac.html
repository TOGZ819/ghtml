<body class="dark">
<module>
<moduleprefs title="Google.com">
<content type="html"><!--[CDATA[

<!DOCTYPE html-->

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/awaiblecomponent/575@main/style.css">

<style>
  canvas:focus { outline: none; }
  html, body {
    padding: 0; margin: 0;
    overflow: hidden;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    -webkit-tap-highlight-color: rgba(0,0,0,0);
    height: 100%;
  }
  #unity-container { position: relative; width: 100%; height: 100%; }
  #unity-canvas { width: 100vw; height: 100vh; display: block; }
</style>

<!-- Unity container/canvas -->
<div id="unity-container" class="unity-desktop">
  <canvas id="unity-canvas" tabindex="-1" style="cursor: default;"></canvas>
</div>

<!-- âœ… Custom loading overlay (your design) -->
<div id="loadingScreen" style="
  position: fixed; inset: 0;
  background: #fff;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  z-index: 9999;
">
  <img src="https://cdn.jsdelivr.net/gh/TOGZ819/togz8.com/media.png" alt="Loading Logo" style="max-width: 300px; margin-bottom: 20px;">
  <div id="loadingProgress" style="
    width: 300px; height: 20px;
    border-radius: 10px; overflow: hidden; background: transparent; border: 1px solid #ddd;
  ">
    <div id="loadingBar" style="
      width: 0%; height: 100%;
      background: #4caf50; border-radius: 10px; transition: width 0.2s ease;
    "></div>
  </div>
</div>

<!-- (Removed the old #loading-cover based loader UI) -->

<script>
  // --- Loading overlay helpers ---
  function updateLoadingProgress(progress) {
    const bar = document.getElementById('loadingBar');
    if (bar) bar.style.width = (progress * 100) + '%';
  }
  function hideLoadingScreen() {
    const scr = document.getElementById('loadingScreen');
    if (scr) scr.style.display = 'none';
  }

  // --- Unity boot config ---
  const hideFullScreenButton = "";
  const buildUrl  = "https://cdn.jsdelivr.net/gh/awaiblecomponent/575@main/Build";
  const loaderUrl = buildUrl + "/zombieshooterdone.loader.js";
  const config = {
    dataUrl: buildUrl + "/zombieshooterdone.data.br",
    frameworkUrl: buildUrl + "/zombieshooterdone.framework.js",
    streamingAssetsUrl: "StreamingAssets",
    companyName: "OnHitDev",
    productName: "They Are Coming",
    productVersion: "1.19"
  };

  // Merge WASM parts -> blob -> createUnityInstance
  const wasmParts = [
    `${buildUrl}/zombieshooterdone.wasm.br.part0`,
    `${buildUrl}/zombieshooterdone.wasm.br.part1`,
    `${buildUrl}/zombieshooterdone.wasm.br.part2`,
    `${buildUrl}/zombieshooterdone.wasm.br.part3`
  ];

  async function fetchAndMergeWasm() {
    const parts = await Promise.all(wasmParts.map(url =>
      fetch(url).then(r => {
        if (!r.ok) throw new Error(`Failed to load ${url}`);
        return r.arrayBuffer();
      })
    ));
    const totalLength = parts.reduce((sum, part) => sum + part.byteLength, 0);
    const merged = new Uint8Array(totalLength);
    let offset = 0;
    for (const part of parts) {
      merged.set(new Uint8Array(part), offset);
      offset += part.byteLength;
    }
    const blob = new Blob([merged], { type: "application/wasm+br" });
    return URL.createObjectURL(blob);
  }

  const container = document.querySelector("#unity-container");
  const canvas    = document.querySelector("#unity-canvas");

  // Mobile class toggle
  if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
    container.className = "unity-mobile";
  }

  // Right-click context menu off
  document.addEventListener('contextmenu', e => e.preventDefault());

  // Focus helpers
  function FocusGame() { window.focus(); canvas.focus(); }
  window.addEventListener('pointerdown', FocusGame);
  window.addEventListener('touchstart',  FocusGame);

  // Globals / stubs you already had
  let StartUnityInstance;
  let myGameInstance;
  let ysdk = null;

  let environmentData = {
    language: "en", domain: "default_domain", deviceType: "desktop",
    isMobile: false, isDesktop: true, isTablet: false, isTV: false,
    appID: "default_app_id", browserLang: navigator.language || "en",
    payload: null, promptCanShow: false, reviewCanShow: false,
    platform: navigator.platform,
    browser: (function() {
      let ua = navigator.userAgent;
      if (ua.includes("YaBrowser")) return "Yandex";
      if (ua.includes("OPR") || ua.includes("Opera")) return "Opera";
      if (ua.includes("Firefox")) return "Firefox";
      if (ua.includes("MSIE") || ua.includes("Trident")) return "IE";
      if (ua.includes("Edge")) return "Edge";
      if (ua.includes("Chrome")) return "Chrome";
      if (ua.includes("Safari")) return "Safari";
      return "Other";
    })()
  };

  let cloudSaves = 'noData';
  let paymentsData = 'none';
  let playerData = 'noData';
  let player = null;
  let payments = null;
  let initGame = false;
  let nowFullAdOpen = false;

  function GetPayments() { console.warn("GetPayments is not implemented"); return Promise.resolve("none"); }
  function SaveCloud() { console.warn("SaveCloud is not implemented"); }
  function LoadCloud() { console.warn("LoadCloud is not implemented"); return Promise.resolve("noData"); }
  function InitPlayer() { console.warn("InitPlayer is not implemented"); return Promise.resolve("noData"); }

  function FullAdShow() {
    try {
      if (!nowFullAdOpen) {
        nowFullAdOpen = true;
        if (initGame) myGameInstance.SendMessage("YandexGame", "OpenFullAd");
        setTimeout(() => {
          nowFullAdOpen = false;
          if (initGame) myGameInstance.SendMessage("YandexGame", "CloseFullAd", "true");
          FocusGame();
        }, 500);
      }
    } catch(e) {}
  }

  function RewardedShow(rewardId) {
    try {
      myGameInstance.SendMessage("YandexGame", "RewardVideo", rewardId);
      function closeRewardedAd() {
        myGameInstance.SendMessage("YandexGame", "CloseRewardVideo");
        FocusGame();
      }
      closeRewardedAd();
    } catch(e) {}
  }

  function StickyAdActivity() { console.warn("StickyAdActivity is not implemented"); }
  function Review() { console.warn("Review is not implemented"); }
  function PromptShow() { console.warn("PromptShow is not implemented"); }
  function InitLeaderboards() { console.warn("InitLeaderboards is not implemented"); }
  function GetLeaderboardScores() { console.warn("GetLeaderboardScores is not implemented"); }
  function SetLeaderboardScores() { console.warn("SetLeaderboardScores is not implemented"); }
  function ConsumePurchase() { console.warn("ConsumePurchase is not implemented"); }
  function ConsumePurchases() { console.warn("ConsumePurchases is not implemented"); }

  function InitGame() {
    try {
      console.log('Init Game Success');
      initGame = true;
      if (nowFullAdOpen === true && myGameInstance != null) {
        myGameInstance.SendMessage('YandexGame', 'OpenFullAd');
      }
    } catch (error) {
      console.error("InitGame sÄ±rasÄ±nda hata:", error);
    }
  }

  window.addEventListener("unhandledrejection", function(event) {
    console.warn("Hata es geÃ§ildi:", event.reason);
    event.preventDefault();
  });

  // ---- Boot Unity with your loader UI ----
  fetchAndMergeWasm().then(blobUrl => {
    config.codeUrl = blobUrl;

    const script = document.createElement("script");
    script.src = loaderUrl;
    script.onload = () => {
      createUnityInstance(canvas, config, (progress) => {
        // ðŸ‘‰ Hook Unity progress into your green bar
        updateLoadingProgress(progress);
      }).then((unityInstance) => {
        myGameInstance = unityInstance;
        // ðŸ‘‰ Hide your overlay once Unity is ready
        hideLoadingScreen();
      }).catch((message) => {
        console.error("Unity yÃ¼kleme hatasÄ±:", message);
      });
    };
    document.body.appendChild(script);
  });

</script>


<div id="ad-container" aria-hidden="false" role="dialog" aria-label="Advertisement">
  <iframe id="ad-iframe" src="https://script.google.com/macros/s/AKfycbzA6GNdpfUShkCh6apD0D21YAUf7A5d3Guhq2PayqLbk_5XG_wQhy0bdYzKJWLhzgMVMQ/exec"
          width="768px" height="95px" scrolling="no" frameborder="0"
          sandbox="allow-scripts allow-popups allow-same-origin"></iframe>
  <button id="close-ad">Close (12)</button>
  <div id="ad-right-mask"></div>
</div>

<script>
  (function () {
    const showDelay = 2000;
    const countdownStart = 12;
    const reappearDelay = 25000;
    const adContainer = document.getElementById('ad-container');
    const closeBtn = document.getElementById('close-ad');

    function showAd() {
      adContainer.style.display = 'block';
      adContainer.classList.remove('hidden');
      adContainer.setAttribute('aria-hidden', 'false');

      let timeLeft = countdownStart;
      closeBtn.textContent = `Close (${timeLeft})`;
      closeBtn.disabled = true;
      closeBtn.classList.remove('enabled');

      const t = setInterval(() => {
        timeLeft--;
        if (timeLeft > 0) {
          closeBtn.textContent = `Close (${timeLeft})`;
        } else {
          clearInterval(t);
          closeBtn.disabled = false;
          closeBtn.classList.add('enabled');
          closeBtn.textContent = 'Close â†“';
        }
      }, 1000);
    }

    setTimeout(showAd, showDelay);

    closeBtn.addEventListener('click', () => {
      if (closeBtn.disabled) return;
      adContainer.classList.add('hidden');
      adContainer.setAttribute('aria-hidden', 'true');
      setTimeout(showAd, reappearDelay);
    });
  })();
</script>

]]>&gt;</content>
</moduleprefs>
</module>
</body>
